(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{139:function(e,t,a){e.exports=a(239)},144:function(e,t,a){},239:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(29),s=a.n(c),o=(a(144),a(145),a(112)),i=(a(79),a(30)),u=(a(148),a(118)),l=(a(150),a(120)),p=(a(151),a(116)),f=a(117),d=a(31),h=a(4),m=a.n(h),v=a(119),b=a(18),g=a(35),x=a.n(g),y=(a(155),a(36)),j=a(70),w=a.n(j),E=y.a.Header,O=y.a.Content,k=y.a.Footer,A=function(e){var t=e.children;return r.a.createElement(y.a,null,r.a.createElement(E,{className:w.a.header},r.a.createElement("div",{className:w.a.logo})),r.a.createElement(O,{style:{padding:"0 50px"}},r.a.createElement("div",{style:{padding:24,minHeight:"calc(100vh - 64px  - 69px)"}},t)),r.a.createElement(k,{style:{textAlign:"center"}},"\xa9React App"))},D=a(109),_=a(110),C=a(121),S=a(111),H=a(48),q=a(122),B=(a(203),a(11)),L=function(e){return new Promise((function(t){return setTimeout(t,e)}))},N=function(e){function t(e){var a;return Object(D.a)(this,t),(a=Object(C.a)(this,Object(S.a)(t).call(this,e))).play=Object(b.a)(m.a.mark((function e(){var t,n,r,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.props.data,a.prevDateData={},n=0;case 3:if(!(n<t.length)){e.next=13;break}return r=t[n],c=r.date,s=r.likeCounts,e.next=7,L();case 7:return a.setState({currentDate:c}),e.next=10,a.translateDate(s);case 10:n++,e.next=3;break;case 13:case"end":return e.stop()}}),e)}))),a.translateDate=function(e){var t=a.props.users,n=Object(H.a)(a),r=n.width,c=n.height,s=n.svg,o=n.yScale;return new Promise((function(n){var i=B.i().duration(100).on("end",n),u={},l=t.map((function(t){var n=(a.prevDateData[t]||0)+(e[t]||0);return u[t]=n,{name:t,value:n}})).sort((function(e,t){return B.a(e.value,t.value)}));a.prevDateData=u;var p=B.e(l,(function(e){return e.value})),f=B.g().range([0,r]).domain([0,p<10?10:p]),d=s.select(".x.axis");d.empty()&&(d=s.append("g").attr("class","x axis").attr("transform","translate(0,".concat(c,")"))),d.transition(i).call(B.b(f)).selectAll("g"),o.domain(l.map((function(e){return e.name})));var h=s.select(".y.axis");h.empty()&&(h=s.append("g").attr("class","y axis")),h.transition(i).call(B.c(o)).selectAll("g");var m=s.select(".bars-g");m.empty()&&(m=s.append("g").attr("class","bars-g"));var v=m.selectAll(".bar").data(l,(function(e){return e.name}));v.enter().append("g").append("rect").attr("class","bar").attr("x",0).style("fill",(function(){})).merge(v).transition(i).attr("height",(function(){return o.bandwidth()})).attr("y",(function(e){return o(e.name)})).attr("width",(function(e){return f(e.value)}));var b=m.selectAll(".label").data(l,(function(e){return e.name}));b.exit().remove(),b.enter().append("g").append("text").attr("class","label").attr("x",(function(e){return 0})).merge(b).transition(i).attr("y",(function(e){return o(e.name)+o.bandwidth()/2+4})).attr("x",(function(e){return f(e.value)+3})).tween("text",(function(e){var t=B.h(this),a=B.h(this).text(),n=e.value,r=B.d(a,n);return function(e){t.text(Math.round(r(e)))}}))}))},a.chart=r.a.createRef(),a.prevDateData={},a.state={currentDate:null},a}return Object(q.a)(t,e),Object(_.a)(t,[{key:"componentDidMount",value:function(){var e=0,t=40,a=30,n=120,r=this.chart.current.parentNode.clientWidth-n-t,c=this.chart.current.parentNode.clientHeight-e-a;this.width=r,this.height=c,this.svg=B.h(this.chart.current).attr("width",r+n+t).attr("height",c+e+a).append("g").attr("transform","translate(".concat(n,",").concat(e,")")),this.yScale=B.f().rangeRound([c,0],.1).padding(.4)}},{key:"render",value:function(){var e=this.state.currentDate;return r.a.createElement("div",null,r.a.createElement("h2",null,e),r.a.createElement("div",{style:{height:400}},r.a.createElement("svg",{ref:this.chart})))}}]),t}(r.a.Component),R="6ab1aebe3d1999c206ae14ddbb366f6a65759bf2",Y="190fe6a7296c449bf9af82e3d25132e765ad8f3e",z=function(e){return new Promise((function(t){return setTimeout(t,e)}))};function M(e,t){return P.apply(this,arguments)}function P(){return(P=Object(b.a)(m.a.mark((function e(t,a){var n,r,c,s,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=100,r=1,c=[];case 3:return e.next=5,z(10);case 5:return e.next=7,fetch("https://qiita.com/api/v2/users/".concat(t,"/items?page=").concat(r,"&per_page=").concat(n),{mode:"cors",method:"get",headers:{Authorization:"Bearer ".concat(a),"Access-Control-Allow-Headers":"total-count","Access-Control-Expose-Headers":"total-count"}});case 7:return o=e.sent,e.next=10,o.json();case 10:s=e.sent,c=c.concat(s),r++;case 13:if(n===s.length){e.next=3;break}case 14:return e.abrupt("return",c);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t){return T.apply(this,arguments)}function T(){return(T=Object(b.a)(m.a.mark((function e(t,a){var n,r,c,s,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=100,r=1,c=[];case 3:return e.next=5,z(10);case 5:return e.next=7,fetch("https://qiita.com/api/v2/items/".concat(t,"/likes?page=").concat(r,"&per_page=").concat(n),{mode:"cors",method:"get",headers:{Authorization:"Bearer ".concat(a),"Access-Control-Allow-Headers":"total-count","Access-Control-Expose-Headers":"total-count"}});case 7:return o=e.sent,e.next=10,o.json();case 10:s=e.sent,c=c.concat(s),r++;case 13:if(n===s.length){e.next=3;break}case 14:return e.abrupt("return",c);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F=function(){var e=Object(b.a)(m.a.mark((function e(t,a){var n,r,c,s,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={},r=m.a.mark((function e(r){var c,s,o,i,u,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t[r],e.next=3,M(c,a);case 3:s=e.sent,o=[],i=0;case 6:if(!(i<s.length)){e.next=15;break}return u=s[i],e.next=10,J(u.id,a);case 10:l=e.sent,o=o.concat(l);case 12:i++,e.next=6;break;case 15:o.forEach((function(e){var t=e.created_at,a=x()(t).format("YYYY-MM-DD");n[a]||(n[a]={}),n[a][c]||(n[a][c]=0),n[a][c]++}));case 16:case"end":return e.stop()}}),e)})),c=0;case 3:if(!(c<t.length)){e.next=8;break}return e.delegateYield(r(c),"t0",5);case 5:c++,e.next=3;break;case 8:return s={},t.forEach((function(e){s[e]=0})),o=[],Object.keys(n).forEach((function(e){o.push({date:e,likeCounts:Object(v.a)({},s,{},n[e])})})),o.sort((function(e,t){return x()(e.date)-x()(t.date)})),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();function I(){return(I=Object(b.a)(m.a.mark((function e(t){var a,n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://qiita.com/api/v2/access_tokens",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:R,client_secret:Y,code:t})});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,r=n.token,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=function(){var e=Object(n.useState)(Array(8).fill(null)),t=Object(d.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(null),h=Object(d.a)(s,2),v=h[0],g=h[1],x=Object(n.useState)(null),y=Object(d.a)(x,2),j=y[0],w=y[1],E=Object(n.useState)(null),O=Object(d.a)(E,2),k=O[0],D=O[1],_=Object(n.useState)(null),C=Object(d.a)(_,2),S=C[0],H=C[1],q=Object(n.useRef)(null);return Object(n.useEffect)((function(){var e=new URL(location.href).searchParams.get("code");e||(location.href="https://qiita.com/api/v2/oauth/authorize?client_id=".concat(R,"&scope=read_qiita")),D(e)}),[]),Object(n.useEffect)((function(){k&&function(e){return I.apply(this,arguments)}(k).then((function(e){H(e)})).catch((function(){location.href="https://qiita.com/api/v2/oauth/authorize?client_id=".concat(R,"&scope=read_qiita")}))}),[k]),r.a.createElement(A,null,r.a.createElement(o.a,{tip:"Loading...",spinning:loading},r.a.createElement(u.a,{gutter:8},a.map((function(e,t){return r.a.createElement(l.a,{key:t,span:6,style:{marginBottom:8}},r.a.createElement(p.a,{value:e,onChange:function(e){var n=Object(f.a)(a);n[t]=e.target.value,c(n)}}))}))),r.a.createElement("div",{style:{textAlign:"right"}},r.a.createElement(i.a,{onClick:Object(b.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.filter((function(e){return e})),e.next=3,F(t,S);case 3:n=e.sent,w(n),g(t);case 6:case"end":return e.stop()}}),e)}))),disabled:!S},"\u53d6\u5f97"),r.a.createElement(i.a,{onClick:function(){q.current.play()},disabled:!j},"\u5b9f\u884c")),r.a.createElement("div",{style:{width:"100%",height:500}},r.a.createElement(N,{ref:q,data:j,users:v}))))};var W=function(){return r.a.createElement(U,null)};s.a.render(r.a.createElement(W,null),document.getElementById("root"))},70:function(e,t,a){e.exports={header:"src-layouts-BasicLayout-index-module__header--2S57j",logo:"src-layouts-BasicLayout-index-module__logo--1Hx4w",spacer:"src-layouts-BasicLayout-index-module__spacer--1sAL6"}}},[[139,1,2]]]);
//# sourceMappingURL=main.55126325.chunk.js.map