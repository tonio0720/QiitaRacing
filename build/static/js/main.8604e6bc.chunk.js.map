{"version":3,"sources":["components/RacingBarChart/index.module.less","components/RacingBarChart/index.js","components/ChartPlayer/index.js","layouts/BasicLayout/index.js","pages/Main/index.js","App.js","index.js","components/ChartPlayer/index.module.less","layouts/BasicLayout/index.module.less"],"names":["module","exports","RacingBarChart","props","moveToDate","dateData","width","height","svg","yScale","user2Color","Promise","resolve","t","d3","duration","on","data","Object","keys","map","user","name","value","sort","a","b","max","d","xScale","range","domain","xAxis","select","empty","append","attr","transition","call","selectAll","axis","barsG","bars","exit","remove","enter","merge","style","bandwidth","labels","tween","selection","this","start","text","end","interpolator","Math","round","chart","React","createRef","margin","current","parentNode","clientWidth","clientHeight","rangeRound","padding","console","log","className","styles","racingBarChart","ref","Component","colors","users","loading","useRef","playid","useState","sliderValue","setSliderValue","playing","setPlaying","useEffect","forEach","i","likeCounts","play","useCallback","pid","length","spinning","background","marginTop","textAlign","date","iconWrapper","type","onClick","disabled","min","onChange","tipFormatter","n","Header","Content","Footer","BasicLayout","children","header","title","minHeight","clientId","clientSecret","token","axios","get","headers","Authorization","response","getAllItems","id","limit","page","items","totalLikesCount","likesCount","likes_count","Error","totalCnt","Number","concat","getAllLikes","itemId","likes","fetchData","userId","totalLikes","j","item","createdAt","created_at","moment","format","emptyData","datesData","push","code","post","client_id","client_secret","gotoOauth","window","location","href","withRouter","setLoading","setUsers","setData","validUsers","setValidUsers","setToken","error","setError","likeExceedError","setLikeExceedError","useLocation","history","useHistory","document","JSON","parse","localStorage","getItem","e","searchParams","URLSearchParams","search","getAccessToken","then","setItem","catch","removeItem","checkToken","message","marginBottom","gutter","Array","fill","_","key","md","sm","xs","placeholder","updatedUsers","target","filter","stringify","ChartPlayer","App","Main","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.8604e6bc.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"racingBarChart\":\"src-components-RacingBarChart-index-module__racingBarChart--27osw\"};","import React from 'react';\nimport * as d3 from 'd3';\n\nimport styles from './index.module.less';\n\nconst time = 100;\n\nexport default class RacingBarChart extends React.Component {\n    constructor(props) {\n        super(props);\n        this.chart = React.createRef();\n        this.user2Color = {};\n    }\n\n    componentDidMount() {\n        const margin = {\n            top: 0,\n            right: 40,\n            bottom: 30,\n            left: 120\n        };\n\n        const width = this.chart.current.parentNode.clientWidth - margin.left - margin.right;\n        const height = this.chart.current.parentNode.clientHeight - margin.top - margin.bottom;\n        this.width = width;\n        this.height = height;\n\n        this.svg = d3.select(this.chart.current)\n            .attr('width', width + margin.left + margin.right)\n            .attr('height', height + margin.top + margin.bottom)\n            .append('g')\n            .attr('transform', `translate(${margin.left},${margin.top})`);\n\n        this.yScale = d3.scaleBand()\n            .rangeRound([height, 0], 0.1)\n            .padding(0.4);\n        console.log(this);\n    }\n\n    moveToDate = (dateData) => {\n        const {\n            width,\n            height,\n            svg,\n            yScale,\n            user2Color\n        } = this;\n\n        return new Promise((resolve) => {\n            const t = d3.transition().duration(time).on('end', resolve);\n\n            const data = Object.keys(dateData).map((user) => {\n                const value = dateData[user] || 0;\n                return {\n                    name: user,\n                    value\n                };\n            }).sort((a, b) => d3.ascending(a.value, b.value));\n\n            const max = d3.max(data, (d) => d.value);\n            const xScale = d3.scaleLinear()\n                .range([0, width])\n                .domain([0, max < 10 ? 10 : max]);\n\n            yScale.domain(data.map((d) => d.name));\n\n            let xAxis = svg.select('.x.axis');\n            if (xAxis.empty()) {\n                xAxis = svg.append('g')\n                    .attr('class', 'x axis')\n                    .attr('transform', `translate(0,${height})`);\n            }\n\n            xAxis.transition(t)\n                .call(d3.axisBottom(xScale))\n                .selectAll('g');\n\n            let axis = svg.select('.y.axis');\n            if (axis.empty()) {\n                axis = svg.append('g')\n                    .attr('class', 'y axis');\n            }\n\n            let barsG = svg.select('.bars-g');\n            if (barsG.empty()) {\n                barsG = svg.append('g')\n                    .attr('class', 'bars-g');\n            }\n\n            const bars = barsG\n                .selectAll('.bar')\n                .data(data, function (d) {\n                    return d.name;\n                });\n\n            bars.exit().remove();\n\n            const enterBars = bars.enter();\n\n            enterBars\n                .append('rect')\n                .attr('class', 'bar')\n                .attr('x', 0)\n                .merge(bars)\n                .style('fill', function (d) {\n                    return user2Color[d.name] || '#333';\n                })\n                .transition(t)\n                .attr('height', () => yScale.bandwidth())\n                .attr('y', function (d) {\n                    return yScale(d.name);\n                })\n                .attr('width', function (d) {\n                    return xScale(d.value);\n                });\n\n            const labels = barsG\n                .selectAll('.label')\n                .data(data, function (d) {\n                    return d.name;\n                });\n\n            labels.exit().remove();\n\n            const enterLabels = labels.enter();\n\n            enterLabels\n                .append('text')\n                .attr('class', 'label')\n                .attr('x', function (d) {\n                    return 0;\n                })\n                .merge(labels)\n                .transition(t)\n                .attr('y', function (d) {\n                    return yScale(d.name) + yScale.bandwidth() / 2 + 4;\n                })\n                .attr('x', function (d) {\n                    return xScale(d.value) + 3;\n                })\n                .tween('text', function (d) {\n                    const selection = d3.select(this);\n                    const start = d3.select(this).text();\n                    const end = d.value;\n                    const interpolator = d3.interpolateNumber(start, end);\n                    return function (t) { selection.text(Math.round(interpolator(t))); };\n                });\n\n            axis.transition(t)\n                .call(d3.axisLeft(yScale))\n                .selectAll('g');\n        });\n    }\n\n    render() {\n        return (\n            <div style={{ height: 400 }} className={styles.racingBarChart}>\n                <svg ref={this.chart} />\n            </div>\n        );\n    }\n}\n","import React, {\n    useEffect,\n    useRef,\n    useState,\n    useCallback,\n} from 'react';\nimport {\n    Icon,\n    Slider,\n    Spin\n} from 'antd';\nimport RacingBarChart from '@/components/RacingBarChart';\n\nimport styles from './index.module.less';\n\nconst colors = [\n    '#1890ff',\n    '#fa8c16',\n    '#52c41a',\n    '#f5222d',\n    '#722ed1',\n    '#eb2f96',\n    '#a0d911',\n    '#13c2c2',\n];\n\nexport default ({\n    data,\n    users,\n    loading,\n}) => {\n    const ref = useRef(null);\n    const playid = useRef(0);\n\n    const [sliderValue, setSliderValue] = useState(0);\n    const [playing, setPlaying] = useState(false);\n\n    useEffect(() => {\n        if (!users) {\n            return;\n        }\n\n        const user2Color = {};\n        users.forEach((user, i) => {\n            user2Color[user] = colors[i];\n        });\n        ref.current.user2Color = user2Color;\n    }, [users]);\n\n    useEffect(() => {\n        if (!ref.current) {\n            return;\n        }\n        ref.current.moveToDate({});\n    }, [ref]);\n\n    useEffect(() => {\n        if (playing || !data) {\n            return;\n        }\n        const { likeCounts } = data[sliderValue];\n        ref.current.moveToDate(likeCounts);\n    }, [sliderValue]);\n\n    const play = useCallback(async () => {\n        if (!data) {\n            return;\n        }\n\n        setPlaying(true);\n        const pid = ++playid.current;\n\n        let i = sliderValue;\n        if (i === data.length - 1) {\n            i = 0;\n        }\n        while (i < data.length) {\n            if (pid !== playid.current) {\n                setPlaying(false);\n                return;\n            }\n            const { likeCounts } = data[i];\n            setSliderValue(i);\n            await ref.current.moveToDate(likeCounts);\n            i++;\n        }\n        setPlaying(false);\n    }, [data, sliderValue]);\n\n    useEffect(() => {\n        setSliderValue(0);\n        if (data && loading) {\n            play();\n        }\n    }, [data, loading]);\n\n    return (\n        <Spin spinning={loading}>\n            <div style={{ background: '#fff', padding: 16, marginTop: 16 }}>\n                <h2 style={{ textAlign: 'center' }}>\n                    {data && data[sliderValue] && data[sliderValue].date}\n                </h2>\n                <RacingBarChart ref={ref} />\n                <div className={styles.iconWrapper}>\n                    {\n                        !playing && (\n                            <Icon\n                                className={styles.play}\n                                type=\"caret-right\"\n                                onClick={play}\n                                disabled={!data}\n                            />\n                        )\n                    }\n                    {\n                        playing && (\n                            <Icon\n                                className={styles.play}\n                                type=\"pause\"\n                                onClick={async () => {\n                                    if (!data) {\n                                        return;\n                                    }\n                                    playid.current++;\n                                    setPlaying(false);\n                                }}\n                                disabled={!data}\n                            />\n                        )\n                    }\n                    <Slider\n                        min={0}\n                        max={data ? data.length - 1 : 0}\n                        value={sliderValue}\n                        onChange={(sliderValue) => {\n                            playid.current++;\n                            setSliderValue(sliderValue);\n                        }}\n                        tipFormatter={(n) => {\n                            if (!data) {\n                                return null;\n                            }\n                            return data[n].date;\n                        }}\n                    />\n                </div>\n            </div>\n        </Spin>\n    );\n};\n","import React from 'react';\n\nimport {\n    Layout\n} from 'antd';\n\nimport styles from './index.module.less';\n\nconst {\n    Header,\n    Content,\n    Footer\n} = Layout;\n\nconst BasicLayout = ({\n    children\n}) => {\n    return (\n        <Layout>\n            <Header className={styles.header}>\n                <div className={styles.title}>Qiita Racer</div>\n            </Header>\n            <Content>\n                <div style={{ padding: 24, minHeight: 'calc(100vh - 64px  - 69px)' }}>\n                    {children}\n                </div>\n            </Content>\n            <Footer style={{ textAlign: 'center' }}>©React App</Footer>\n        </Layout>\n    );\n};\n\nexport default BasicLayout;\n","import React, {\r\n    useEffect, useState,\r\n} from 'react';\r\nimport {\r\n    Button,\r\n    Input,\r\n    Row,\r\n    Col,\r\n    Alert\r\n} from 'antd';\r\nimport axios from 'axios';\r\nimport moment from 'moment';\r\nimport { withRouter, useLocation, useHistory } from 'react-router-dom';\r\n\r\nimport ChartPlayer from '@/components/ChartPlayer';\r\nimport Layout from '@/layouts/BasicLayout';\r\n\r\nconst clientId = '6ab1aebe3d1999c206ae14ddbb366f6a65759bf2';\r\nconst clientSecret = '190fe6a7296c449bf9af82e3d25132e765ad8f3e';\r\n\r\nasync function checkToken(token) {\r\n    const response = await axios.get('https://qiita.com/api/v2/items', {\r\n        headers: {\r\n            Authorization: `Bearer ${token}`\r\n        }\r\n    });\r\n    return response;\r\n}\r\n\r\nasync function getAllItems(id, token) {\r\n    const limit = 100;\r\n    let page = 1;\r\n    let items = [];\r\n\r\n    let totalCnt;\r\n    do {\r\n        const response = await axios.get(`https://qiita.com/api/v2/users/${id}/items?page=${page}&per_page=${limit}`, {\r\n            headers: {\r\n                Authorization: `Bearer ${token}`\r\n            }\r\n        });\r\n        let totalLikesCount = 0;\r\n        response.data.forEach(({ likes_count: likesCount }) => {\r\n            totalLikesCount += likesCount;\r\n        });\r\n\r\n        if (totalLikesCount > 1000) {\r\n            throw new Error('Over1000LikesCount');\r\n        }\r\n\r\n        totalCnt = Number(response.headers['total-count']);\r\n        items = items.concat(response.data);\r\n    } while (page++ * limit < totalCnt);\r\n\r\n    return items;\r\n}\r\n\r\nasync function getAllLikes(itemId, token) {\r\n    const limit = 100;\r\n    let page = 1;\r\n    let likes = [];\r\n\r\n    let totalCnt;\r\n    do {\r\n        const response = await axios.get(`https://qiita.com/api/v2/items/${itemId}/likes?page=${page}&per_page=${limit}`, {\r\n            headers: {\r\n                Authorization: `Bearer ${token}`\r\n            }\r\n        });\r\n\r\n        totalCnt = Number(response.headers['total-count']);\r\n        likes = likes.concat(response.data);\r\n    } while (page++ * limit < totalCnt);\r\n\r\n    return likes;\r\n}\r\n\r\nconst fetchData = async (users, token) => {\r\n    const data = {};\r\n    for (let i = 0; i < users.length; i++) {\r\n        const userId = users[i];\r\n        const items = await getAllItems(userId, token);\r\n        let totalLikes = [];\r\n\r\n        for (let j = 0; j < items.length; j++) {\r\n            const item = items[j];\r\n            const likes = await getAllLikes(item.id, token);\r\n            totalLikes = totalLikes.concat(likes);\r\n        }\r\n\r\n        totalLikes.forEach(({ created_at: createdAt }) => {\r\n            const date = moment(createdAt).format('YYYY-MM-DD');\r\n            if (!data[date]) {\r\n                data[date] = {};\r\n            }\r\n            if (!data[date][userId]) {\r\n                data[date][userId] = 0;\r\n            }\r\n            data[date][userId]++;\r\n        });\r\n    }\r\n\r\n    const emptyData = {};\r\n    users.forEach((user) => {\r\n        emptyData[user] = 0;\r\n    });\r\n\r\n    let datesData = [];\r\n    Object.keys(data).forEach((date) => {\r\n        datesData.push({\r\n            date,\r\n            likeCounts: { ...emptyData, ...data[date] }\r\n        });\r\n    });\r\n\r\n    datesData.sort((a, b) => moment(a.date) - moment(b.date));\r\n    datesData = datesData.map((n, i) => {\r\n        if (datesData[i - 1]) {\r\n            users.forEach((user) => {\r\n                n.likeCounts[user] = n.likeCounts[user] || 0;\r\n                n.likeCounts[user] += datesData[i - 1].likeCounts[user];\r\n            });\r\n            return n;\r\n        }\r\n        return n;\r\n    });\r\n\r\n    return datesData;\r\n};\r\n\r\nasync function getAccessToken(code) {\r\n    const response = await axios.post('https://qiita.com/api/v2/access_tokens', {\r\n        client_id: clientId,\r\n        client_secret: clientSecret,\r\n        code\r\n    });\r\n\r\n    const { token } = response.data;\r\n    return token;\r\n}\r\n\r\nfunction gotoOauth() {\r\n    window.location.href = `https://qiita.com/api/v2/oauth/authorize?client_id=${clientId}&scope=read_qiita`;\r\n}\r\n\r\nconst userCount = 8;\r\n\r\nexport default withRouter(() => {\r\n    const [loading, setLoading] = useState(false);\r\n    const [users, setUsers] = useState([]);\r\n    const [data, setData] = useState(null);\r\n    const [validUsers, setValidUsers] = useState(null);\r\n    const [token, setToken] = useState(null);\r\n    const [error, setError] = useState(false);\r\n    const [likeExceedError, setLikeExceedError] = useState(false);\r\n    const location = useLocation();\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        document.title = 'Qiita Racer';\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        try {\r\n            const users = JSON.parse(window.localStorage.getItem('users'));\r\n            setUsers(users || []);\r\n        } catch (e) {\r\n            //\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const searchParams = new URLSearchParams(location.search);\r\n        const token = searchParams.get('token') || window.localStorage.getItem('token');\r\n        const code = searchParams.get('code');\r\n        if (code) {\r\n            getAccessToken(code).then((token) => {\r\n                window.localStorage.setItem('token', token);\r\n                history.push(`?token=${token}`);\r\n                setToken(token);\r\n            }).catch(() => {\r\n                window.localStorage.removeItem('token');\r\n                gotoOauth();\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (token) {\r\n            checkToken(token).then(() => {\r\n                setToken(token);\r\n            }).catch(() => {\r\n                window.localStorage.removeItem('token');\r\n                gotoOauth();\r\n            });\r\n            return;\r\n        }\r\n\r\n        gotoOauth();\r\n    }, []);\r\n\r\n    if (!token) {\r\n        return (\r\n            <Layout>\r\n                <div>トークンを取得します。</div>\r\n            </Layout>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Layout>\r\n            <div style={{ background: '#fff', padding: 16 }}>\r\n\r\n                {error && <Alert type=\"error\" message=\"エラーが発生しました。\" style={{ marginBottom: 8 }} />}\r\n                {likeExceedError && <Alert type=\"error\" message=\"LGTMが1000を超えるユーザーは取得できません。\" style={{ marginBottom: 8 }} />}\r\n\r\n                <Row gutter={8}>\r\n                    {Array(userCount).fill(null).map((_, i) => {\r\n                        const user = users[i];\r\n                        return (\r\n                            <Col key={i} md={6} sm={12} xs={24} style={{ marginBottom: 8 }}>\r\n                                <Input\r\n                                    placeholder=\"ユーザーIDを入力してください。\"\r\n                                    value={user}\r\n                                    onChange={(e) => {\r\n                                        const updatedUsers = [...users];\r\n                                        updatedUsers[i] = e.target.value;\r\n                                        setUsers(updatedUsers);\r\n                                    }}\r\n                                />\r\n                            </Col>\r\n                        );\r\n                    })}\r\n                </Row>\r\n\r\n                <div style={{ textAlign: 'center' }}>\r\n                    <Button\r\n                        type=\"primary\"\r\n                        onClick={() => {\r\n                            const validUsers = users.filter((n) => n);\r\n                            if (validUsers.length === 0) {\r\n                                return;\r\n                            }\r\n\r\n                            window.localStorage.setItem('users', JSON.stringify(validUsers));\r\n\r\n                            setData(null);\r\n                            setError(false);\r\n                            setLikeExceedError(false);\r\n                            setValidUsers(null);\r\n\r\n                            setLoading(true);\r\n                            fetchData(validUsers, token).then((data) => {\r\n                                setData(data);\r\n                                setValidUsers(validUsers);\r\n                                setLoading(false);\r\n                            }).catch((e) => {\r\n                                console.log(e);\r\n                                if (e.message === 'Over1000LikesCount') {\r\n                                    setLikeExceedError(true);\r\n                                }\r\n                                setLoading(false);\r\n                                setError(true);\r\n                            });\r\n                        }}\r\n                        disabled={!token}\r\n                        loading={loading}\r\n                    >\r\n                        データ取得\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n            <ChartPlayer data={data} loading={loading} users={validUsers} />\r\n        </Layout>\r\n    );\r\n});\r\n","import React from 'react';\nimport { BrowserRouter } from 'react-router-dom';\nimport Main from '@/pages/Main';\n\nfunction App() {\n    return (\n        <BrowserRouter>\n            <Main />\n        </BrowserRouter>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.less';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconWrapper\":\"src-components-ChartPlayer-index-module__iconWrapper--2KqqT\",\"play\":\"src-components-ChartPlayer-index-module__play--1nv6S\",\"stop\":\"src-components-ChartPlayer-index-module__stop--1SIZv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"src-layouts-BasicLayout-index-module__header--2S57j\",\"title\":\"src-layouts-BasicLayout-index-module__title--321a5\",\"logo\":\"src-layouts-BasicLayout-index-module__logo--1Hx4w\",\"spacer\":\"src-layouts-BasicLayout-index-module__spacer--1sAL6\"};"],"sourceRoot":""}